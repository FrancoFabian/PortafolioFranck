(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["b4ab5213fa58eedc168e27aa1c3790c8"],{"3atX":function(e,t,r){"use strict";r("5DmW");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var a=o(r("q1tI"));var i=n(r("Pwnf"));var s=r("Rry3");function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};if(n.get||n.set){Object.defineProperty(t,r,n)}else{t[r]=e[r]}}}}t.default=e;return t}}var c=function e(t){var r=t.disabled,n=r===void 0?false:r;var o=(0,s.faceIconColor)(n);return a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M22 11.5C22 6.25 17.75 2 12.5 2C7.25 2 3 6.25 3 11.5C3 16.24 6.47 20.17 11.02 20.89V14.25H8.60V11.5H11.02V9.41C11.02 7.03 12.43 5.71 14.60 5.71C15.64 5.71 16.73 5.90 16.73 5.90V8.23H15.53C14.35 8.23 13.98 8.97 13.98 9.72V11.5H16.62L16.20 14.25H13.98V20.89C18.53 20.17 22 16.24 22 11.5Z",fill:o("#1877F2")}),a.createElement("path",{d:"M16.20 14.25L16.62 11.5H13.98V9.72C13.98 8.97 14.35 8.23 15.53 8.23H16.73V5.90C16.73 5.90 15.64 5.71 14.60 5.71C12.43 5.71 11.02 7.03 11.02 9.41V11.5H8.60V14.25H11.02V20.89C11.50 20.96 12.00 21 12.5 21C13.00 21 13.50 20.96 13.98 20.89V14.25H16.20Z",fill:o(i.default.white)}))};var u=c;t.default=u},gCLx:function(e,t,r){"use strict";r("+2oP");r("3KgV");r("5DmW");r("07d7");r("5s+n");Object.defineProperty(t,"__esModule",{value:true});t.getFacebookAuthToken=t.loadFacebookApi=t.loginWithFacebook=t.FACEBOOK_LOGIN_MUTATION=t.getErrorMessageByCode=void 0;r("ls82");var p=r("o1mU");var n=s(r("lTCR"));var h=r("4PhQ");var o=i(r("whzC"));var a=r("DiaA");var g=r("Y8R6");var v=r("MVfM");var b=r("c+8j");var i18n=i(r("HEOz"));function i(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};if(n.get||n.set){Object.defineProperty(t,r,n)}else{t[r]=e[r]}}}}t.default=e;return t}}function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t,r,n,o,a,i){try{var s=e[a](i);var c=s.value}catch(e){r(e);return}if(s.done){t(c)}else{Promise.resolve(c).then(n,o)}}function u(s){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=s.apply(e,i);function o(e){c(n,t,r,o,a,"next",e)}function a(e){c(n,t,r,o,a,"throw",e)}o(undefined)})}}function l(){var t=f(['\n    mutation loginWithFacebookMutation(\n        $token: String!\n        $role: UserRole\n        $inviteId: String\n    ) {\n        loginWithFacebook(token: $token, role: $role, inviteId: $inviteId) {\n            user {\n                id\n                kaid\n                canAccessDistrictsHomepage\n                isTeacher\n                hasUnresolvedInvitations\n                transferAuthUrl(pathname: "")\n                preferredKaLocale {\n                    id\n                    kaLocale\n                }\n            }\n            isFirstLogin\n            error {\n                code\n            }\n        }\n    }\n']);l=function e(){return t};return t}function f(e,t){if(!t){t=e.slice(0)}return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var d=function e(t){switch(t){case"ALREADY_LOGGED_IN":return i18n._("Ya est\u00e1s conectado con otra cuenta de Facebook. Por favor, cierra sesi\u00f3n de esa cuenta e int\u00e9ntalo de nuevo.");case"INVITE_NOT_FOUND":return i18n._("Your invitation was not found. Please try clicking the link in your email again.");case"INVALID_TOKEN":default:return i18n._("\u00a1Ups! Algo fall\u00f3. Por favor intenta de nuevo.")}};t.getErrorMessageByCode=d;var w=(0,n.default)(l());t.FACEBOOK_LOGIN_MUTATION=w;var k=function(){var r=u(regeneratorRuntime.mark(function e(r){var n,o,a,i,s,c,u,l,f,d;return regeneratorRuntime.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:n=r.token,o=r.role,a=r.signupCodes,i=r.inviteId;t.prev=1;t.next=4;return(0,p.apolloMutate)(w,{variables:{token:n,role:(0,b.roleToUserRole)(o),inviteId:i}});case 4:s=t.sent;if(!s.data.loginWithFacebook.error){t.next=9;break}c=s.data.loginWithFacebook.error.code;if(c==="SHADOWS_EXISTING_ACCOUNT"){(0,g.redirect)("/login/oauth/verify?oauth_type=facebook&fb_access_token=".concat(n))}throw new h.KAError(c,h.Errors.Internal);case 9:u=s.data.loginWithFacebook,l=u.user,f=u.isFirstLogin;d={user:l,isFirstLogin:f};if(!(a&&a.length)){t.next=15;break}t.next=14;return(0,v.joinClassroomsPostlogin)(a);case 14:d.joinClassrooms=t.sent;case 15:(0,b.setAnalyticsCookies)(f,l.kaid);return t.abrupt("return",d);case 19:t.prev=19;t.t0=t["catch"](1);if(!(t.t0 instanceof h.KAError)){t.next=23;break}throw t.t0;case 23:throw new h.KAError("Failed to login with Facebook",h.Errors.Internal);case 24:case"end":return t.stop()}}},e,null,[[1,19]])}));return function e(t){return r.apply(this,arguments)}}();t.loginWithFacebook=k;var y=function e(){if(typeof window!=="undefined"&&window.FB){return Promise.resolve(window.FB)}return new Promise(function(e,t){var r=document.createElement("script");r.src=o.safeLinkTo("https://connect.facebook.net/en/sdk.js?xfbml=1&kidDirectedSite=1");r.onload=function(){e(window.FB)};r.onerror=function(e){t(e)};document.body.appendChild(r)})};t.loadFacebookApi=y;var O=function e(){return y().then(function(e){return new Promise(function(t,r){e.init({version:"v2.7",appId:a.FB_APP_ID,status:false,cookie:true,xfbml:true,oauth:true,kidDirectedSite:true});e.login(function(e){if(e.authResponse){t(e.authResponse.accessToken)}else{r(new h.KAError("Could not get FB access token",h.Errors.Internal))}},{scope:"email"})})})};t.getFacebookAuthToken=O},"m+8x":function(e,t,r){"use strict";r("ma9I");r("5DmW");r("NBAS");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n=h(r("q1tI"));var i=h(r("ZpD3"));var s=r("gCLx");var c=r("ANZR");var u=r("sPtk");var o=a(r("4Du/"));var l=r("Y8R6");var f=a(r("4PhQ"));var d=a(r("etw9"));var p=a(r("3atX"));var i18n=h(r("HEOz"));function a(e){return e&&e.__esModule?e:{default:e}}function h(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};if(n.get||n.set){Object.defineProperty(t,r,n)}else{t[r]=e[r]}}}}t.default=e;return t}}function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function b(e,t,r){if(t)v(e.prototype,t);if(r)v(e,r);return e}function w(e,t){if(t&&(typeof t==="object"||typeof t==="function")){return t}return y(e)}function k(e){k=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return k(e)}function y(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function O(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)m(e,t)}function m(e,t){m=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return m(e,t)}function C(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var P=function(e){O(a,e);function a(){var e;var o;g(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}o=w(this,(e=k(a)).call.apply(e,[this].concat(r)));C(y(o),"state",{error:null,loading:false,loggingIn:false});C(y(o),"preloadFacebookApi",function(){o.setState({loading:true});(0,s.loadFacebookApi)().then(function(e){o.setState({loading:false});return e}).catch(function(e){o.setState({error:e,loading:false})})});C(y(o),"handleError",function(e){var t=o.props.onError;var r=(0,s.getErrorMessageByCode)(e.message);f.default.log("Something unexpected happened!",{code:e.message,message:r});if(t){t(r)}o.setState({error:null,loading:false,loggingIn:false})});C(y(o),"handleClick",function(e){if(o.state.loading||o.state.error){return}o.setState({loading:true});var t=o.props.minorConversions;if(t){i.markMinorConversions(t)}(0,s.getFacebookAuthToken)().then(function(e){o.setState({loggingIn:true});var t=!!o.props.onReauthSuccess;if(t){o.doReauth(e)}else{o.doLogin(e)}}).catch(function(e){if(e){o.handleError(e)}var t=o.props.onReauthError;if(t){var r=(0,c.createReauthUrl)("facebook",e.message);t(r)}})});C(y(o),"doLogin",function(e){(0,s.loginWithFacebook)({token:e,signupCodes:o.props.classCodes,role:o.props.role,inviteId:o.props.inviteId}).then(function(e){var t=o.props.postLoginContinueUrl;var r=t?t:"/";var n=(0,u.calculateNextUrl)({location:o.props.location,userData:e.user,loginType:"facebook",continueUrl:r,isFirstLogin:e.isFirstLogin,joinClassrooms:e.joinClassrooms});(0,l.redirect)(n)}).catch(function(e){o.handleError(e)})});C(y(o),"doReauth",function(e){(0,c.reauthWithThirdParty)("facebook",e).then(function(e){var t=(0,c.createReauthUrl)("facebook");if(o.props.onReauthSuccess){o.props.onReauthSuccess(t)}o.setState({loggingIn:false,loading:false})}).catch(function(e){o.handleError(e);var t=(0,c.createReauthUrl)("facebook",e.message);if(o.props.onReauthError){o.props.onReauthError(t)}else{(0,l.redirect)(t)}o.setState({loading:false})})});return o}b(a,[{key:"componentDidMount",value:function e(){this.preloadFacebookApi()}},{key:"render",value:function e(){var t=this.state.loading||!!this.props.disabled;return n.createElement(d.default,{title:!this.state.loggingIn?i18n._("Contin\u00faa con Facebook"):i18n._("Iniciando tu sesi\u00f3n..."),iconComponent:p.default,disabled:t,onClick:this.handleClick,width:this.props.width,grow:this.props.grow,shrink:this.props.shrink,size:this.props.size})}}]);return a}(n.Component);var j=(0,o.default)(P);t.default=j}}]);
//# sourceMappingURL=../../sourcemaps/en/b4ab5213fa58eedc168e27aa1c3790c8.6b44dd23772a1d078bcd.js.map