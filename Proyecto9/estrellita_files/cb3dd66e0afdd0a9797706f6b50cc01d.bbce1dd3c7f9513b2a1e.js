(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cb3dd66e0afdd0a9797706f6b50cc01d"],{"3Owj":function(t,e){window.AceEditor=Backbone.View.extend({dom:{TEXT_INPUT:"textarea",CONTENT:"div.ace_content"},tooltips:{ace_pjs:["imagePicker","soundModal","colorPicker","numberScrubberClick","autoSuggest","numberScrubber"],ace_webpage:["imageModal","colorPicker","numberScrubber"],ace_sql:["numberScrubber"]},initialize:function t(e){var i=this;this.defaultCode=e.code;this.autoFocus=e.autoFocus;this.config=e.config;this.record=e.record;this.type=e.type;this.workersDir=e.workersDir;this.editor=ace.edit(this.el);this.textarea=this.$(this.dom.TEXT_INPUT);this.content=this.$(this.dom.CONTENT);this.offset=this.content.offset();if(this.record){this.bindRecord()}this.tooltipEngine=new TooltipEngine({tooltips:this.tooltips[this.type],type:this.type,imagesDir:e.imagesDir,soundsDir:e.soundsDir,editor:this.editor,record:this.record});this.tooltipEngine.on("scrubbingStarted",function(t){this.trigger("scrubbingStarted",t)}.bind(this));this.tooltipEngine.on("scrubbingEnded",function(t){this.trigger("scrubbingEnded",t)}.bind(this));if(this.tooltips[this.type].indexOf("autoSuggest")!==-1){ScratchpadAutosuggest.init(this.editor)}ace.require("ace/tooltip").Tooltip.prototype.setPosition=function(t,e){var i=$(this.$parentNode).offset();var o=i.left-$(window).scrollLeft();var n=i.top-$(window).scrollTop();t-=o;e-=n;this.getElement().style.left=t+"px";this.getElement().style.top=e+"px"};if(this.$el.resizable){this.$el.resizable({handles:"s",resize:function t(){i.editor.resize()}})}var o=$("<iframe>").css({width:"100%",height:0,position:"absolute",visibility:"hidden"}).appendTo(this.el);$(o[0].contentWindow.window).on("resize",function(){this.editor.resize();this.editor.setFontSize(this.$el.width()<400?"12px":"14px")}.bind(this));this.$el.on("mousedown",".tooltip",function(t){t.preventDefault()});this.editor.commands.removeCommand("gotoline");this.editor.commands.bindKey("Alt-0",null);this.editor.selection.addEventListener("changeCursor",function(){i.setErrorHighlight(false)});this.editor.on("change",function(){i.trigger("change");if(this.editor.curOp&&this.editor.curOp.command.name){i.trigger("userChangedCode")}}.bind(this));this.editor.on("click",function(){i.trigger("click")});this.editor.selection.on("changeCursor",function(){i.trigger("changeCursor")});this.editor.selection.on("changeSelection",function(){i.trigger("changeCursor")});this.config.on("versionSwitched",function(t){i.config.runVersion(t,i.type+"_editor",i)});this.config.editor=this;this.reset()},remove:function t(){this.tooltipEngine.remove()},bindRecord:function t(){var n=this;var r=this.editor;var e=this.record;var c=r.session.doc;c.on("change",function(t){var e=t.data.range.start;var i=t.data.range.end;if(t.data.action.indexOf("insert")===0){var o=t.data.lines||t.data.text;n.record.log(t.data.action,e.row,e.column,i.row,i.column,o)}else{n.record.log(t.data.action,e.row,e.column,i.row,i.column)}},true);r.selection.addEventListener("changeCursor",function(){if(r.selection.isEmpty()){n.handleSelect()}},true);r.selection.addEventListener("changeSelection",this.handleSelect.bind(this),true);var i=["insertText","insertLines","removeText","removeLines"];_.each(i,function(s){e.handlers[s]=function(t,e,i,o,n){var r={action:s,range:{start:{row:t,column:e},end:{row:i,column:o}}};if(s==="insertText"){r.text=n}else if(s==="insertLines"){r.lines=n}c.applyDeltas([r])}});$.extend(e.handlers,{select:function t(e,i,o,n){if(o==null){o=e}if(n==null){n=i}r.selection.setSelectionRange({start:{row:e,column:i},end:{row:o,column:n}})}});e.seekCachers.editor={getState:function t(){return{text:n.text(),cursor:n.getCursor()}},restoreState:function t(e){n.text(e.text);n.setCursor(e.cursor)}};e.on("runSeek",function(){n.reset(e.initData.code)})},handleSelect:function t(){if(!this.record.recording){return}var e=this.editor.selection.getRange();var i=e.start;var o=e.end;this.record.log("select",i.row,i.column,o.row,o.column)},reset:function t(e,i){e=e||this.defaultCode;this.config.runCurVersion(this.type+"_editor",this);this.text(e);this.setCursor({row:0,column:0},i)},setErrorHighlight:function t(e){this.editor.setHighlightActiveLine(e)},toggleGutter:function t(e){this.editor.renderer.setShowGutter(e)},getAllFolds:function t(){var e=this.editor.session;return _.map(e.getAllFolds(),function(t){return[t.start.row,t.end.row]})},setFolds:function t(e){_.each(e,function(t){this.editor.session.foldAll(t[0],t[1],0)}.bind(this))},blockPaste:function t(i){var o=this.editor;if(!o.originalCut){o.originalCut=o.onCut;o.originalCopy=o.onCopy;o.originalPaste=o.onPaste}o.onCut=function(t){o.lastCopied=this.getSelectedText();o.originalCut.apply(o)};o.onCopy=function(t){o.lastCopied=this.getSelectedText();o.originalCopy.apply(o)};o.onPaste=function(t){var e=function t(e){return e.match(/\s*https?:\/\/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)\s*/)};if(t===o.lastCopied||t.length<3||e(t)){o.originalPaste.apply(o,[t]);return}else{i()}};var e=false;o.container.addEventListener("dragstart",function(){e=true});o.container.addEventListener("dragend",function(){e=false});o.container.addEventListener("drop",function(t){if(!e){i();t.stopPropagation()}},true)},focus:function t(){if(this.autoFocus!==false){this.editor.focus()}},getCursor:function t(){return this.editor.getCursorPosition()},getSelectionIndices:function t(){var e=this.editor.getSelectionRange();var i=this.editor.getSession().getDocument();return{start:i.positionToIndex(e.start),end:i.positionToIndex(e.end)}},setCursor:function t(e,i){this.editor.moveCursorToPosition(e);this.editor.clearSelection();if(i!==false&&this.autoFocus!==false){this.editor.focus()}},setSelection:function t(e){this.editor.selection.setSelectionRange(e)},setReadOnly:function t(e){this.editor.setReadOnly(e)},text:function t(e){if(e!=null){this.editor.getSession().setValue(e)}else{return this.editor.getSession().getValue().replace(/\r\n/g,"\n")}return this},unfold:function t(){return this.editor.getSession().unfold()},insertNewlineIfCursorAtEnd:function t(){var e=this.editor.getSession().getLength()-1;var i=this.editor.getSession().getLine(e);var o=i.length;var n=this.editor.getCursorPosition();if(n.row===e&&n.column===o){var r=this.text();if(r.length&&r[r.length-1]!=="\n"){this.text(this.text()+"\n");this.setCursor({row:e+1,column:0})}}},undo:function t(){this.editor.undo()}});LiveEditor.registerEditor("ace_pjs",AceEditor);LiveEditor.registerEditor("ace_webpage",AceEditor);LiveEditor.registerEditor("ace_sql",AceEditor)}}]);
//# sourceMappingURL=../../sourcemaps/en/cb3dd66e0afdd0a9797706f6b50cc01d.bbce1dd3c7f9513b2a1e.js.map